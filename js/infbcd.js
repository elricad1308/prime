/**
* infbcd.js
*
* Este script contiene los datos de la simulacion del experimento con
* el protocolo BCC (Blocked Customer Cleared) version infinita.
*
* @author Jose Aguilar-Canepa
*/

/** 
* Estos datos corresponden a la resolucion de la cadena utilizando 
* el metodo recursivo.
*/
var recursive = [
  [0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.5603314111835153, 0.538824037522971, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.225707621118126, 0.3428835076187272, 0.5867121015824458, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.09918559216234343, 0.08563427580186049, 0.31314424749853204, 0.7684167750482646, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.09319578133134825, 0.0974078184085184, 0.0745870710414884, 0.23573669497836408, 0.7581271824651596, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.0732316700787306, 0.0961585298261685, 0.024278690832912824, 0.12367748944994583, 0.17045596147110514, 0.8228815000332672, 0.0, 0.0, 0.0, 0.0],
  [0.020284827136835902, 0.06836089984146018, 0.06739758799214911, 0.06583164863955439, 0.03532626696475012, 0.23184455239493235, 0.9151294846993014, 0.0, 0.0, 0.0],
  [0.03903128412821983, 0.0162882301523192, 0.07688135632418669, 0.021665129860034115, 0.04627974154818411, 0.07406576120590391, 0.22174528411898617, 0.9012370908867096, 0.0, 0.0],
  [0.09024952102667697, 0.05994678791827164, 0.07730170395455836, 0.06269682330584994, 0.013524973041126754, 0.05970567397131436, 0.09395025431556023, 0.1858835176388806, 0.8919234499738068, 0.0],
  [0.06682459095873891, 0.09372225441360864, 0.07065333788665205, 0.08598415010661652, 0.031675183060249336, 0.0378104758410646, 0.003179044131429099, 0.021211481615215768, 0.19661528876846593, 0.9297375946745926]
];

/**
* Estos datos corresponden a la resolucion de la cadena utilizando
* una simulacion de la cadena.
*/
var simulated = [
  [0.471241724421, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.5160302267973994, 0.5905624341963519, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.1900724236606844, 0.303293187672106, 0.5875003429595586, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.08939924164526963, 0.07938026963232166, 0.26508613274003234, 0.6944045079635711, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.07696648922438935, 0.0916060348466654, 0.06282073480074415, 0.21389588894096742, 0.8443066022330453, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.04927770782943447, 0.015967423167508134, 0.060144218783957024, 0.09554824899927054, 0.21945906888858446, 0.8294770010467023, 0.0, 0.0, 0.0, 0.0],
  [0.09723530105816156, 0.00457562198561163, 0.030175105900553903, 0.09702634079854204, 0.0763727058925448, 0.21070551913171026, 0.9250197635336496, 0.0, 0.0, 0.0],
  [0.04918561659074476, 0.08943132471481029, 0.09096888218338006, 0.026629894391304264, 0.04659654543027723, 0.11466536151697987, 0.13009815579278436, 0.8622320015687704, 0.0, 0.0],
  [0.04381113408234786, 0.0821800191557405, 0.07879836564726023, 0.05204680198975383, 0.04303808749971534, 0.03407291781034747, 0.01823475136910998, 0.14240722382849813, 0.923957064210899, 0.0],
  [0.051795358399890336, 0.07496422323668335, 0.007538999858679532, 0.07755634572127643, 0.06494874194483473, 0.0617838022208248, 0.010121650721178823, 0.09290105457588457, 0.17510371545564335, 0.9261476881265583]
];

/**
* Estos datos corresponden a la resolucion de la cadena mediante el 
* metodo de Gauss-Seidel.
*/
var gauss = [
  [0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.5260038461128623, 0.560988700956087, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.20344071810142583, 0.35775004151835044, 0.5896534009724597, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.11401115437936729, 0.12326362839657687, 0.27640181660785507, 0.7740668575265819, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.06687780891671861, 0.10582454951673913, 0.13235923551062237, 0.2519624038853703, 0.8406606262586959, 0.0, 0.0, 0.0, 0.0, 0.0],
  [0.035396348366715846, 0.026054569830539862, 0.10612532519417091, 0.11871119852188594, 0.24194357419954626, 0.805910743639626, 0.0, 0.0, 0.0, 0.0],
  [0.0724183786742604, 0.07380334796295189, 0.05395968467683481, 0.03402869255308316, 0.10903642440761685, 0.2098797841755081, 0.8534586888411508, 0.0, 0.0, 0.0],
  [0.08242058536274742, 0.07090800816896844, 0.01931730128245258, 0.04593153731746357, 0.026907166385771467, 0.09682135800089847, 0.15692666506771819, 0.9042722105128056, 0.0, 0.0],
  [0.016904417319125266, 0.05108086098283947, 0.05567669311350735, 0.09442872765620383, 0.015969242372643844, 0.028718696624707562, 0.02828385997244106, 0.11027681829157956, 0.9354337986840904, 0.0],
  [0.08835223997271978, 0.05440007208344826, 0.06347931710478488, 0.023300334041740776, 0.013365009307567156, 0.051173999947015235, 0.05393497812111619, 0.027066891290771902, 0.15388292834849698, 0.9354367700340263]
];

// Transformamos los datos al formato requerido por Plotly.
var data = [
  { 
    z : recursive, 
    visible : true,
    type : 'surface', 
    opacity : 0.75,
    name : 'Recursive',
    colorscale : 'Rainbow',
    showscale : false,
    hoverinfo : 'all'
  },

  { 
    visible : true,
    z : simulated, 
    type : 'surface', 
    opacity : 0.75,
    name : 'Simulation',
    colorscale : 'Picnic',
    showscale : false
  },

  { 
    visible : true,
    z : gauss,
    type : 'surface', 
    opacity : 0.75,
    name : 'Direct',
    colorscale : 'Earth',
    showscale : false
  }
];

var layout = {
      title : '\u03c0i of Infinite BCD',
      width : 994,
      height : 600,

      scene : {
            xaxis : {
                  title : 'S',
                  type : 'linear',
                  tickmode : 'linear',
                  tick0: 0,
                  dtick: 1,
                  ticks : 'inside',
                  mirror : false
            }, 

            yaxis : {
                  title : 'i',
                  type : 'linear',
                  tickmode : 'linear',                  
                  tick0 : 0,
                  dtick: 1,
                  ticks : 'outside',
                  mirror : false
            },

            zaxis : {
                  title : '\u03c0i'
            }
      }
}

// Creamos el widget para visualizar los datos.
Plotly.plot('experiment', data, layout);

// Agregamos los eventos para mostrar/ocultar a los botones
$('.control-div button').click(function() {
      var index = -1;

      if(this.id === 'recursive') 
            index = 0;
      else if (this.id === 'sim') 
            index = 1;
      else if (this.id === 'gauss') 
            index = 2;
      else 
            index = -1;

      if(index === -1) {
            console.warn('Unknown id: ' + this.id);
            return;
      } else {
            plot = document.getElementById('experiment');
            var op = plot.data[index].opacity;

            if(op === undefined) op = 1.0;

            var update = {
                  opacity : (op === 1 ? 0.75 : 1.0)
            }

            Plotly.restyle(plot, update, index);
      }
});